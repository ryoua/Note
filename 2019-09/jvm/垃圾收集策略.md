### 判断对象死亡

垃圾收集的第一步就是判断哪些对象是垃圾，一般业界常用的有两种方法

第一种是引用计数法：引用计数法就是在对象中添加一个引用计数器，每当有一个地方引用它时，计数器+1，引用失效时，计数器-1，当计数器为0时，就代表对象已经没用了，但是这种方法没法解决循环有用的问题，如果A引用B，B也引用A，但是AB现在都没有其他东西在引用了，这时候两者就都无法回收。

第二种是可达性分析：可达性分析就是通过一系列叫做GC Root的根对象作为起始点，从起点开始，根据引用关系向下搜索，搜索过程走过的路径称为引用链，如果某个对象到GC Root间没有任何引用链，那么这个对象就是不可达的，就可以回收。

#### GC Roots

1. 虚拟机栈中引用的对象，譬如各个线程被调用的方法的堆栈使用的参数，局部变量，临时变量等
2. 本地方法栈中引用的对象
3. 方法区中类静态属性引用的对象
4. 方法区中常量引用的对象
5. 虚拟机内部的引用，比如Class对象，一些常驻的异常对象，还有系统类加载器
6. 所有被同步锁持有的对象

#### 引用类型

Java中的对象引用有四种，分别是

- 强引用：无论如何，只要强引用关系存在，垃圾收集器就永远不会回收被引用的对象
- 软引用：主要描述一些还有用，但是非必须的对象，只有在即将发生内存溢出前，会把这些对象列入回收范围之中进行第二次回收，如果这次回收没有足够的内存，才会抛出内存溢出异常。
- 弱引用：描述一些非必须的对象，比软引用还要弱一些，弱引用关联的对象只能活到下一次垃圾收集发生为止
- 虚引用：最弱的引用关系，并没有实质作用，主要就是让对象在被收集器回收时，能收到一个系统通知

#### 确定对象死亡

一般即使经过可达性分析后，对象被标记为不可达，这时候对象也不是非死不可，还有可以有方法自救，来防止被垃圾收集器回收。

要宣告一个对象真正死亡，需要两个步骤，第一个步骤是进行可达性分析，如果发现不可达，那么会进行第一次标记，随后进行一次筛选，筛选的条件就是对象是否有必要执行finallize方法，如果对象没有重写该方法，或者该方法已经被调用，那么虚拟机认为没有必要执行。

如果对象被判定为有必要执行，那么对象会被放入一个叫做F-Queue的低优先级队列中，低优先级主要方法回收过程中出现阻塞的问题从而影响主线程运行，然后会执行finalize方法，如果改方法中，对象成功与引用链上的任何一个对象建立关联，那么就不会被收集，反之，稍后收集器会对F-Queue中的对象进行第二次小规模的标记。这时对象会被移入即将回收的一个集合中，被彻底回收，任何一个对象的finalize方法都只会被调用一次。

 

# 垃圾收集算法

在了解垃圾收集算法之前，我们需要了解一下理论知识。

###  分代收集理论

目前的大部分商业垃圾收集器，都遵循分代收集理论，分代收集理论基于两个假说

1. 弱分代假说：大部分对象都是朝生夕死的
2. 强分代假说：熬过越多次垃圾收集的对象就越难以消亡
3. 跨代引用假说：跨代引用相对于同代引用占少数

这两个假说确定了分代收集理论：收集器应该将Java堆划分出不同的区域，然后将回收对象根据其年龄，分配到不同的区域中存储，比如大部分的朝生夕死的对象就应该放到新生代中，而大部分的难以消亡的对象，应该放在老年代，因为把他们放在新生代是没有意义的，因为大部分情况下他们都不会被收集。

尽管分代收集理论很完美，但是有一个问题，当我们进行Minor GC时，新生代对象在引用老年代对象时，我们不能直接回收新生代对象。所以我们需要找出新生代对象引用了老年代哪些对象，直接遍历的话，性能很差，所以Hotspot采用了记忆集的一个结构，这个结构把老年代划分为若干块，标识出老年代哪一块存在跨代引用，此后发生Minor GC的时候，只有包含了跨代引用的小块内存里的对象才会被加入到GC Roots中进行扫描。

- Minor GC/Young GC：新生代的垃圾收集
- Major GC/Old GC：老年代的收集
- Mixed GC：混合收集，G1独有
- Full GC：整堆收集，同时收集堆和方法区

### 标记清除算法

顾名思义，标记清除就是先标记处所有需要回收的对象，在标记完成后，统一进行垃圾回收，但是这种方法有两个缺点，第一是效率不稳定，如果大部分对象都是需要回收的，那么这时候需要进行大量标记和清除的动作，导致标记和清除两个过程的效率都随着对象增长而降低。第二个缺点是内存空间的碎片化问题，标记清除之后会产生大量的不连续空间，导致很多内存碎片，内存碎片太多可能会导致下一次进行内存分配大对象时明明空间足够，确因为没有连续的空间而分配失败。从而触发一次垃圾收集

### 标记整理算法

标记整理和标记清除的区别就是在清理阶段，标记整理在标记完可回收对象后，会让所有存活对象都往一端移动，然后直接清理掉边界以外的内存。当有大量对象需要移动时，整理的代价会很大，所以一般标记整理会用在清理对象较少的老年代。

### 复制算法

复制算法的出现主要是为了解决标记清除算法面对大量清除对象效率低的问题，它将内存按容量划分为大小相等的两个区，每次只使用一个内存块，当一块内存用完后，就将存活的对象复制到另外一块上，然后再把已使用的内存空间一次性清理掉，当大部分都是存活对象时，复制算法有大量的内存开销，但是如果大部分都是销毁对象时，复制算法只需要移动少量对象到另外一块上，然后直接清除另外一块即可。但是复制算法的代价就是需要浪费一半的内存空间

不过在实际实现中，不会选用对办分这样的做法，因为一般复制算法都用在新生代的收集中，而新生代的收集大多是朝生夕死，所以一般会按照8:1:1的比例来进行分配，即一个大的eden区和两个小的surivor区，每次使用时，使用一个eden区和一个小的surivor区，之后将存活的对象放入另外一个surivor区。

之所以使用两个surivor区主要是防止内存碎片

![一个Survivor区带来碎片化](data:image/png;base64,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)

 

 

# 一些实现细节

### 根节点枚举

- 迄今为止，所有收集器在根节点枚举这一步骤都是必须暂停用户线程的，因此毫无疑问根节点枚举与之前提及的整理内存碎片一样会面临相似的"Stop     The World"的困扰。
- 由于目前主流Java虚拟机使用的都是准确式垃圾收集，所以当用户线程停顿下来之后，其实并不需要一个不漏的检查完所有执行上下文和全局的引用位置，虚拟机应当是有办法直接得到哪些地方存放着对象引用的。     在HotSpot的解决方案里，是使用一组称为OopMap的数据结构来达到这个目的。一旦类加载动作完成的时候，HotSpot就会把对象内什么偏移量上是什么类型的数据计算出来。这样收集器在扫描时就可以直接得知这些信息了 ，并不需要真正一个不漏地从方法区等GC Roots开始查找。 

### 安全点

- HotSpot没有为每条指令都生成OopMap，因为将会需要大量的额外存储空间，只是在"特定的位置"记录了这些信息，这些位置被称为安全点。有了安全点的设定，也就决定了用户程序执行时并非在代码指令流的任意位置都能够停顿下来开始垃圾收集，而是强制要求必须执行到达安全点后才能够暂停。因此，安全点的选定既不能太少以至于让收集器等待时间过长，也不能太过频繁以至于过分增大运行时的内存负荷。安全点位置的选取基本上是以"是否具有让程序长时间执行的特征"为标准进行选定的，因为每条指令执行的时间都非常短暂，程序不太可能因为指令流长度太长这样的原因而长时间执行，"长时间执行"的最明显特征就是指令序列的复用，     例如方法调用、循环跳转、异常跳转等都属于指令序列复用，所以只有具有这些功能的指令才会产生安全点。

- 对于安全点，另一个需要考虑的问题是，如何在垃圾收集发生时让所有线程都跑到最近的安全点，然后停顿下来。这里有以下两种方案可供选择：

- - 抢先式中断：不需要线程的执行代码主动去配合，在垃圾收集发生时，系统首先把所有用户线程全部中断，如果发现有用户线程中断的地方不在安全点上，就恢复这条线程执行，让它一会再重新中断，直到跑到安全点上。      现在几乎没有虚拟机实现采用抢先式中断来暂停线程响应GC事件。
  - 主动式中断：主动式中断的思想是当垃圾收集需要中断线程的时候，不直接对线程操作，仅仅简单地设置一个标志位，各个线程执行过程时会不停地主动去轮询这个标志，一旦发现中断标志为真时就自己在最近的安全点上主动中断挂起。      轮询标志的地方和安全点是重合的，另外还要加上所有创建对象和其他需要在Java堆上分配内存的地方，这是为了检查是否即将要发生垃圾收集，避免没有足够内存分配新对象。

### 安全区域

- 安全点机制保证了程序执行时，在不太长的时间内就会遇到可进入垃圾收集过程的安全点。但是，程序"不执行"的时候呢？所谓的程序不执行就是没有分配处理器时间，典型的场景便是用户线程处于Sleep状态或者Blocked状态，这时候线程无法响应虚拟机的中断请求，     不能再走到安全的地方中断挂起自己，虚拟机也显然不可能持续等待线程重新被激活分配处理器时间。对于这种情况，就必须引入安全区域（Safe     Region）来解决。
- 安全区域是指能够确保在某一段代码片段之中，引用关系不会发生变化，因此，在这个区域中任意地方开始垃圾收集都是安全的。我们也可以把安全区域看作被扩展拉伸的安全点。
- 当用户线程执行到安全区域里面的代码时，首先会标识自己已经进入了安全区域，那样当这段时间里虚拟机要发起垃圾收集时就不必去管这些已经申明自己在安全区域内的线程了。当线程要离开安全区域时，它要检查虚拟机是否已经完成了根节点枚举（或者垃圾收集过程中其他需要暂停用户线程的阶段），如果完成了，那线程就当做没事发生过，继续执行；否则它就必须一直等待，知道收到可以离开安全区域的信号为止。

### 记忆集和卡表

- 讲解分代收集理论的时候，提到了为解决对象跨代引用所带来的问题，垃圾收集器在新生代中建立了名为记忆集（Remembered     Set）的数据结构，用以避免把整个老年代加进GC Roots扫描范围。

- 记忆集是一种用于记录从非收集区域指向收集区域的指针集合的抽象数据结构。     在垃圾收集场景中，收集器只需要通过记忆集判断出某一块非收集区域是否存在有指向了收集区域的指针就可以了，并不需要了解这些跨代指针的全部细节。     下面列举了一些可供选择的记录精度：

- - 字长精度：每个记录精确到一个机器字长（就是处理器的寻址位数，如常见的32位或64位，这个精度决定了机器访问物理内存地址的指针长度），该字包含了跨代指针。
  - 对象精度：每个记录精确到一个对象，该对象里有字段含有跨代指针。
  - 卡精度：每个记录精确到一块内存区域，该区域内有对象含有跨代指针。

- 其中，第三种"卡精度"所指的是用一种称为"卡表"（Card     Table）的方式去实现记忆集，这也是目前最常用的一种记忆集实现形式。卡表是记忆集的一种具体实现，它定义了记忆集的记录精度、与堆内存的映射关系等。     关于卡表与记忆集的关系，可以按照Java语言中HashMap和Map的关系来类比理解。

- 卡表最简单的形式可以只是一个字节数组，以下这行代码是HotSpot默认的卡表标记逻辑：CARD_TABLE     [this address >> 9] = 0;

- 字节数组CARD_TABLE的每一个元素都对应着其标识的内存区域中一块特定大小的内存块，这个内存块被称作"卡页"（Card     Page）。一般来说，卡页大小都是以2的N次幂的字节数，通过上面代码可以看出HotSpot中使用的卡页是2的9次幂，即512字节（地址右移9位，     相当于用地址除以512）。

- 一个卡页的内存中通常包含不止一个对象，只要卡页内存内有一个（或多个）对象的字段存在着跨代指针，那就将对应卡表的数组元素的值标识为1，称为这个元素变脏（Dirty），没有则标识为0。     在垃圾收集发生时，只要筛选出卡表中变脏的元素，就能轻易得出哪些卡页内存块中包含跨代指针，把它们加入GC Roots中一并扫描。 

### 写屏障

- 卡表元素何时变脏的答案是很明确的——有其他分代区域中对象引用了本区域对象时，其对应的卡表元素就应该变脏，变脏时间点原则上应该发生在引用类型字段赋值的那一刻。
- 在HotSpot虚拟机里是通过写屏障（Write     Barrier）技术维护表状态的（也就是变脏）。写屏障可以看作在虚拟机层面对"引用类型字段赋值"这个动作的AOP切面，在引用对象赋值时产生一个环形（Around）通知，供程序执行额外的动作，     也就是说赋值的前后都写屏障的覆盖范畴内。在赋值前的部分的写屏障叫作写前屏障（Pre-Write     Barrier），在赋值之后的则叫作写后屏障（Post-Write Barrier）。     HotSpot虚拟机的许多收集器都有使用到写屏障，但直至G1收集器之前，其他收集器都只用到了写后屏障。下面这段代码清单 3-6     是一段更新卡表状态的简化逻辑。

void oop_field_store(oop* field, oop new_value) {
  // 引用字段赋值操作
  *field = new_value;
  // 写后屏障，在这里完成卡表状态更新
  post_write_barrier(field, new_value);
 }

- 应用写屏障后，虚拟机就会为所有赋值操作生成相应的指令，一旦收集器在写屏障中增加了更新卡表操作，无论更新的是不是老年代对新生代对象的引用，每次只要对引用进行更新，就会产生额外的开销，不过这个开销与Minor     GC时扫描整个老年代的代价相比是低得多的。
- 除了写屏障的开销外，卡表在高并发场景下还面临着"伪共享"（False     Sharing）问题。伪共享是处理并发底层细节时一种经常需要考虑的问题，现代中央处理器的缓存中是以缓存行（Cache     Line）为单位存储的，当多线程修改互相独立的变量时，     如果这些变量恰好共享同一个缓存行，就会彼此影响（写回，无效化或者同步）而导致性能降低，这就是伪共享问题。
- 为了避免伪共享问题，一种简单的解决方案是不采用无条件的写屏障，而是先检查卡表标记，只有当该卡表元素未被标记过时才将其标记为变量，即将卡表更新的逻辑变为以下代码所示：

if (CARD_TABLE [this address >> 9] != 0)
  CARD_TABLE [this address >> 9] = 0;

 